<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>DjVu Imager</title>
</head>

<body>

<h2 align="center">DjVu Imager</h2>

<h3 align="center">Руководство пользователя</h3>

<p><strong>DjVu Imager</strong> - это программа для создания
серых или цветных иллюстраций в DjVu-книге,
базирующаяся на комбинации метода подклейки
фона и метода раскраски маски (OC Windows).</p>

<p>Программа принимает на входе задние субсканы
из специальным образом подготовленных <strong>п<em>а</em>р
субсканов</strong>, преобразует каждый такой задний
субскан в готовую DjVu-картинку, и подклеивает их в
целевую DjVu-книгу (т.е. в многостраничный
чёрно-белый DjVu-файл).</p>

<p>Пары субсканов предполагается создавать в
СканКромсаторе 5.92 - хотя это можно делать в любом
графическом редакторе.</p>

<p><strong>DjVu Imager</strong> имеет лицензию &quot;GPL 2 и выше&quot;
и полностью открытые исходные коды.</p>

<p>Программа работает как под Win98, так и под Win2000/XP.</p>

<p><strong>DjVu Imager</strong> использует бесплатную
программную графическую библиотеку <a
href="http://freeimage.sourceforge.net/">FreeImage</a> (под лицензией GPL).</p>

<hr>

<h4>Схема работы:</h4>

<p align="center"><strong>СканКромсатор 5.92 -&gt; пары
субсканов -&gt; задний субскан -&gt; DjVu Imager.</strong></p>

<hr>

<p><strong>Использование:</strong></p>

<p>1. Подготовьте пары субсканов в СканКромсаторе
5.92.</p>

<p>2. Запустите файл <strong>DjVu Imager.exe</strong>.</p>

<p>3. Откройте задние субсканы путём нажатия
кнопок либо <strong>Открыть файл(ы),</strong> либо <strong>Открыть
папку</strong>.</p>

<p>4. В столбце <strong>№</strong> автоматически
сформируются номера загруженных файлов (на базе
их имён). Каждый такой номер обозначает номер той
DjVu-страницы, куда будет вклеен данный
загруженный графический файл (в качестве
иллюстрации). При необходимости можно изменить
вручную любой такой номер (по двойному щелчку
мыши на нём).</p>

<p>5. При желании выберите параметры кодирования: <strong>ДЗФ</strong>
или <strong>Качество задн. фона.</strong></p>

<p>6. Используя переключатели <strong>Все файлы</strong> / <strong>Текущий
файл</strong>, можно установить индивидуальные
параметры кодирования для любого из файлов в
списке.</p>

<p>7. Нажмите кнопку <strong>Пуск</strong>, чтобы запустить
создание группы DjVu-картинок.</p>

<p>8. Выберите целевую DjVu-книгу путём нажатия
кнопки <strong>Источн.</strong>. При этом автоматически
заполнится поле с путём к выходной копии целевой
DjVu-книги (этот путь можно изменить при помощи
кнопки <strong>Назнач.</strong>).</p>

<p>9. Нажмите кнопку <strong>Вставить в DjVu</strong>.
Готовые DjVu-картинки автоматически вставятся в
соответствующие места копии исходной DjVu-книги
(При этом исходная DjVu-книга остаётся неизменной).</p>

<p>10. В том месте, куда указывает путь назначения (<em>Рабочий
Стол</em> по умолчанию), будет создана копия
исходной DjVu-книги с внедрёнными в неё
DjVu-картинками. Это и есть результат работы
программы.</p>

<hr>

<h4>Подробности:</h4>

<p>Файл <strong>DjVu Imager.exe</strong> - это просто GUI,
управляющий консольными экзешниками из пакета <a
href="http://djvu.sourceforge.net/">DjVuLibre</a>.</p>

<p>Используемые утилиты:</p>

<p>- <strong>c44-fi.exe</strong> - модифицированная (<a
href="http://www.djvu-soft.ru/soft/fi_c44.htm">с поддержкой FreeImage</a>)
консольная утилита <strong><a href="c44.html">c44.exe</a></strong>
(для создания DjVu-картинок).</p>

<p>- <strong><a href="djvmcvt.html">djvmcvt.exe</a></strong> - консольная
утилита для распаковки-упаковки многостраничных
DjVu-файлов на отдельные страницы.</p>

<p>- <strong>djvudumpm.exe</strong> - модифицированная (<a
href="https://sourceforge.net/forum/forum.php?thread_id=3289524&amp;forum_id=103286">с
выводом в текстовый файл</a>) консольная утилита <a
href="djvudump.html">djvudump</a> - для получения информации о
структуре DjVu-книги.</p>

<p>- <strong><a href="djvuextract.html">djvuextract.exe</a></strong> -
консольная утилита для разборки одностраничных
DjVu-файлов на составляющие компоненты (чанки).</p>

<p>- <strong><a href="djvumake.html">djvumake.exe</a></strong> - консольная
утилита для сборки одностраничных DjVu-файлов из
составляющих компонент (чанков). Здесь
используется её версия, модифицированная
Алексеем Крюковым.</p>

<p>- <strong><a href="djvm.html">djvm.exe</a></strong> - консольная
утилита для сборки полученных DjVu-картинок во
временный многостраничный DjVu-файл (для
последующего его показа по кнопке <strong>Просмотр</strong>).</p>

<hr>

<h4>Элементы управления:</h4>

<p>Кнопка <strong>Открыть файл(ы)</strong>: Открывает и
загружает субсканы заднего фона.</p>

<p><strong>Открыть папку</strong> - действует аналогично.</p>

<p>Кнопки <strong>+</strong> (&quot;плюс&quot;) и <strong>-</strong>
(&quot;минус&quot;) - добавление нового элемента /
удаление текущего элемента списка.</p>

<p><strong>ДЗФ</strong> - делитель (разрешения) заднего
фона. Может принимать значения от 2 до 12.</p>

<p><strong>Качество задн. фона</strong> - качество заднего
фона. Может принимать значения от 0 до 50.</p>

<p>Переключатели <strong>Все файлы</strong> / <strong>Текущий
файл</strong> - задают область применения параметров <strong>ДЗФ</strong>
и<strong> Качество задн. фона</strong> либо ко всем, либо
к данному файлу (в списке файлов).</p>

<p>Кнопка <strong>С</strong> - сброс всех ранее
установленных параметров <strong>Текущий файл</strong>
и приведение их к режиму <strong>Все файлы</strong>.</p>

<p>Кнопка <strong>Пуск</strong> - запуск процесса создания
группы DjVu-картинок.</p>

<p>Кнопка <strong>Просмотр</strong> - просмотр полученных
DjVu-картинок - в виде временного (!)
многостраничного DjVu-файла - в установленном в
системе DjVu-просмотрщике.</p>

<p>Кнопка <strong>Текущий </strong>- запускает
кодирование и просмотр текущего файла с
применением текущих для данного файла опций
кодирования. Применяется для подбора
оптимального индивидуального для данного файла
набора опций.</p>

<p>Кнопка <strong>Вставить в DjVu</strong> - автоматическая
вставка готовых DjVu-картинок в соответствующие
места целевой DjVu-книги.</p>

<p>Кнопка <strong>Источн.</strong> - ввод имени целевой
DjVu-книги (для обработки по кнопке <strong>Вставить в
DjVu</strong>).</p>

<p>Кнопка <strong>Назнач.</strong> - ввод/смена имени
выходной копии целевой DjVu-книги.</p>

<hr>

<h4>Опции:</h4>

<p>При нажатии на кнопку <strong>Опции</strong>
открывается окно выбора опций программы.</p>

<p>Флажок с выпадающим списком <strong>DPI</strong> -
вкл./выкл и выбрать желаемое значение DPI.</p>

<p>Флажок <strong>Открыть DjVu-файл после
конвертирования</strong> - вкл./выкл. автоматическое
открытие временного многостраничного DjVu-файла
после создания DjVu-картинок в результате нажатия
кнопки <strong>Convert.</strong></p>

<p>Флажок <strong>Открыть DjVu-файл после вставки</strong> -
вкл./выкл. автоматическое открытие целевой
DjVu-книги после вставки туда DjVu-картинок в
результате нажатия кнопки <strong>Вставить в DjVu.</strong></p>

<p>Флажок <strong>Выводить на Рабочий Стол</strong> -
вкл./выкл. автоматическое формирование пути
выходного целевого файла на <strong>Рабочий Стол</strong>
(при выборе по кнопке <strong>Источн.</strong>). Когда эта
опция выключена, путь целевого файла формируется
в ту же самую папку, где лежит обрабатываемая
DjVu-книга.</p>

<p>Поле <strong>Суффикс вых. файла:</strong> выбор
суффиска, добавляемого к целевой DjVu-книге, в
которую внедряются готовые DjVu-картинки.</p>

<p>Флажок <strong>Произвольные файлы</strong> - вкл./выкл.
режима произвольных (задаваемых пользователем)
шаблонов имён задних субсканов. При
использовании этого режима программа
автоматически формирует фильтр выбора имён
файлов, который используется затем вместо
нотации СканКромсатора 5.92 при открытии файлов и
папок.</p>

<p>Флажок <strong>Узнавать имена файлов Scan Tailor</strong> -
вкл./выкл. режима, при котором программа
автоматически узнаёт формат имён файлов от Scan
Tailor и правильно преобразует такие имена файлов в
соответствующие номера файлов. Этот флажок
рекомендуется всегда держать включённым.</p>

<p><strong>Добавка к имени</strong> - текстовый элемент,
добавляемый к имени заднего субскана.</p>

<p><strong>Приставка</strong> - Добавка к имени
вставляется перед цифровым именем заднего
субскана.</p>

<p><strong>Суффикс</strong> - Добавка к имени вставляется
после цифрового имени заднего субскана.</p>

<p><strong>Нет </strong>- открываются любые
поддерживаемые графические файлы (это значение
по-умолчанию).</p>

<p><em>Примечания:</em> </p>

<p>1. Имена файлов задних субсканов (без расширения
и без суффикса &quot;sep&quot; (или без задаваемых
пользователем приставки-суффикса - если есть))
должны являться подстроками внутренних имён
файлов (без расширения) страниц DjVu-книги, на
которые они вставляются (иначе вставка не
произойдёт). При использовании СканКромсатора 5.92
это достигается автоматически. Правильность
имён можно увидеть, просматривая содержимое
заполненной папки <strong>tmp</strong>.</p>

<p>2. Запрещено использовать <strong>Добавка к имени</strong>
состоящую из цифр.</p>

<p>3. Вставка DjVu-картинок в несоответствующую
DjVu-книгу приводит к ошибке или к отсутствию
вставки.</p>

<hr>

<h4>Замечания:</h4>

<p>1. Все изменённые вручную параметры программы
автоматически запоминаются.</p>

<p>2. По умолчанию субсканы заднего фона должны
иметь имена в нотации СканКромсатора 5.92:</p>

<p>0001.sep.tif, 0002.sep.tif, ..., 0100.sep.tif, ...</p>

<p>3. Все созданные DjVu-картинки остаются после
закрытия программы в служебной папке <strong>tmp</strong>.
Эта папка очищается только в момент создания
новых DjVu-файлов.</p>

<p>4. Имена файлов в списке могут быть только
уникальными. Добавление файла с повторяющимся
именем блокируется. При добавлении файла в
список список автоматически
пересортировывается. Каждый файл в списке
хранится с индивидуальным путём - поэтому
допускается набирать список из разных папок.</p>

<p>5. Программа поддерживает Drag-and-Drop как для
файлов, так и для папок.</p>

<p>6. Файлы, для которых установлена опция <strong>Текущий
файл</strong>, выделяются жирным шрифтом в списке
файлов.</p>

<p>7. Между кнопками <strong>Просмотр</strong> и <strong>Текущий</strong>
выводится суммарный размер имеющихся в данный
момент DjVu-картинок. Этот размер автоматически
обновляется при каждом кодировании.</p>

<p>8. Параметр <strong>Качество задн. фона</strong> задаёт
значение опции <strong>-slices</strong> у утилиты <a href="c44.html">c44.exe</a>
по следующей формуле:</p>

<p>- Всегда используются не более 4 чанков (хотя
максимально возможно до 15).</p>

<p>- Первый чанк всегда равен 70.</p>

<p>- Текущее значение бегунка прибавляется к
значению первого чанка. Реальный диапазон
регулирования получается равным от 70 до 120 (хотя
максимально возможно до 210, однако это не имеет
никакого практического смысла, т.к. качество не
растёт после 120).</p>

<p>- Текущее значение бегунка делится поровну
между оставшимися 3 чанками. А именно делится на 16
с остатком - и полученные числа (включая остаток)
назначаются 3 чанкам. В случае значения бегунка
&gt; 48 второй чанк увеличивается на 1 или 2 (чтобы не
вводить 5-ый чанк).</p>

<p>9. При обработке страницы многостраничного
DjVu-файла чанк переднего плана сохраняется (если
он есть) или создаётся &quot;с нуля&quot; (если его нет),
а чанк(и) заднего фона (если он есть)
отбрасывается и заменяется на субскан заднего
фона.</p>

<p>10. Пиксельные размеры вклеиваемой иллюстрации
должны быть равны пиксельным размерам
соответствующей обклеиваемой DjVu-страницы (или
размерам её копии, субсемплированной в диапазоне
1..12). Субсемплированные размеры определяются по
формуле из csepdjvu (<a
href="http://djvu.cvs.sourceforge.net/viewvc/djvu/djvulibre-3.5/tools/csepdjvu.cpp?revision=1.30&amp;view=markup">http://djvu.cvs.sourceforge.net/viewvc/djvu/djvulibre-3.5/tools/csepdjvu.cpp?revision=1.30&amp;view=markup</a>
строка 1080 и 1081):</p>

<p>int subw = (w + bgred - 1) / bgred;<br>
int subh = (h + bgred - 1) / bgred;</p>

<p>где subw, subh - размеры субсемплированного
изображения<br>
w, h - размеры исходного изображения<br>
bgred - целочисленный фактор субсемплирования (в
диапазоне 1..12)</p>

<hr>

<h4>Известные недостатки программы:</h4>

<p>1. При создании новой папки в окне выбора папки
это окно автоматически закрывается и его нужно
вновь открыть вручную, чтобы увидеть созданную
папку. Возможная причина: в Win98, по-видимому, не
работает (или плохо работает) раскрытие узла
дерева по команде.</p>

<hr>

<h4>Авторы:</h4>

<p><strong>Алексей Крюков</strong>&nbsp; &lt;anagnost at yandex dot ru&gt;<br>
<strong>monday2000</strong>.</p>

<p>Создание GUI:</p>

<p><strong>monday2000</strong>.</p>

<hr>

<p>03.06.2009.</p>

<p><a target="blank" href="http://www.djvu-soft.narod.ru/">http://www.djvu-soft.narod.ru/</a></p>
</body>
</html>
